src/create_dataset.py \
  --output_dir sana_outputs2 \
  --n_train 10 \
  --n_test 10 \
  --batch_size 8 \
  --save_latents \
  --save_activations \
  --save_post_final_layer_norm_latents \
  --component_type cross_attn \
  --timesteps_step 2 \
  --layers_step 4



python src/create_dataset.py \
  --output_dir sana_outputs2 \
  --n_train 10000 \
  --n_test 1000 \
  --batch_size 4 \
  --save_latents \
  --timesteps_step 1

python src/create_dataset.py \
  --output_dir sana_outputs2 \
  --n_train 10 \
  --n_test 10 \
  --batch_size 4 \
  --save_post_final_layer_norm_latents \
  --timesteps_step 1


  python src/create_dataset.py \
  --output_dir sana_outputs2 \
  --n_train 10 \
  --n_test 10 \
  --batch_size 4 \
  --save_activations \
  --component_type mix_ffn \
  --timesteps_step 5 \
  --layers_step 5


python src/create_dataset.py \
  --output_dir sana_outputs2 \
  --n_train 10 \
  --n_test 10 \
  --batch_size 4 \
  --save_activations \
  --component_type self_attn \
  --timesteps_step 5 \
  --layers_step 5


python src/create_dataset.py \
  --output_dir sana_outputs2 \
  --n_train 10 \
  --n_test 10 \
  --batch_size 4 \
  --save_activations \
  --component_type cross_attn \
  --timesteps_step 5
  --layers_step 5





  python src/test_create_dataset.py\
  --post_layernorm_latents_file sana_outputs/train/post_layer_norm_latents/timestep_136_accumulate_13.pt \
  --output_dir sana_outputs



  python src/test_create_dataset.py\
  --latents_file sana_outputs2/train/latents/timestep_136.pt \
  --output_dir sana_outputs2 \
  --split train 



    python src/test_create_dataset.py \
    --output_dir sana_outputs2 \
    --activations_file sana_outputs/train/activations/timestep_999/layer_00/mix_ffn_accumulate_19.pt


    python src/test_create_dataset.py \
    --output_dir sana_outputs2 \
    --split train \
    --timestep 499 \
    --layer 10 \
    --component self_attn


     python src/test_create_dataset.py \
    --output_dir sana_outputs2 \
    --split train \
    --timestep 499 \
    --layer 10 \
    --component cross_attn






    #real


    ./py-sbatch.sh src/create_dataset.py \
    --output_dir sana_outputs \
    --n_train 10000 \
    --n_test 1000 \
    --batch_size 4 \
    --save_post_final_layer_norm_latents \
    --timesteps_step 5



./py-sbatch.sh src/create_dataset.py \
  --output_dir sana_outputs \
  --n_train 5000 \
  --n_test 500 \
  --batch_size 4 \
  --save_activations \
  --component_type mix_ffn \
  --timesteps_step 5 \
  --layers_step 5

  ./py-sbatch.sh src/create_dataset.py \
  --output_dir sana_outputs \
  --n_train 5000 \
  --n_test 500 \
  --batch_size 4 \
  --save_activations \
  --component_type self_attn \
  --timesteps_step 5 \
  --layers_step 5


  ./py-sbatch.sh src/create_dataset.py \
  --output_dir sana_outputs \
  --n_train 5000 \
  --n_test 500 \
  --batch_size 4 \
  --save_activations \
  --component_type cross_attn \
  --timesteps_step 5 \
  --layers_step 5



./py-sbatch.sh src/probe.py \
  --latents_folder_train sana_outputs/train/post_layer_norm_latents \
  --latents_folder_test sana_outputs/test/post_layer_norm_latents \
  --timestep 999 \
  --accumulate_mode \
  --latent_type guided \
  --kernel_size 3 \
  --batch_size 16 \
  --models_output_folder sana_outputs2/probes \
  --test_output_folder sana_outputs2/evals \
  --test_results_file_path_mae sana_outputs2/results_mae.csv \
  --test_results_file_path_spearman sana_outputs2/results_spearman.csv \
  --gradient_type Vertical \
  --accumulate_size 500



python src/probe.py \
  --latents_folder_train sana_outputs/train/post_layer_norm_latents \
  --latents_folder_test sana_outputs/test/post_layer_norm_latents \
  --timestep 136 \
  --accumulate_mode \
  --latent_type guided \
  --kernel_size 1 \
  --batch_size 16 \
  --models_output_folder sana_outputs2/probes \
  --test_output_folder sana_outputs2/evals \
  --test_results_file_path_mae sana_outputs2/results_mae.csv \
  --test_results_file_path_spearman sana_outputs2/results_spearman.csv \
  --gradient_type Vertical \
  --accumulate_size 500




python src/run_all_probes.py --base_folder sana_outputs --kernel_size 3 --gradient_type Gaussian --latents_name post_layer_norm_latents



./py-sbatch.sh src/create_dataset.py \
  --output_dir sana_outputs \
  --n_train 10000 \
  --n_test 1000 \
  --batch_size 4 \
  --save_activations \
  --component_type mix_ffn \
  --layers_step 5 \
  --timesteps 999



  python src/create_figures.py \
    --csv sana_outputs/results_mae_post_layer_norm_latents.csv \
    --x timestep --y mae \
    --title_col gradient_type --line_group_col kernel \
    --out figures/mae_by_gradient_type.png

python src/create_figures.py \
    --csv sana_outputs/results_spearman_post_layer_norm_latents.csv \
    --x timestep --y spearman \
    --title_col gradient_type --line_group_col kernel \
    --out figures/spearman_by_gradient_type.png


python src/create_figures_layers.py --csv sana_outputs/results_spearman_activations.csv --metric spearman --out_folder figures


python src/create_figures_layers.py --csv sana_outputs/results_mae_activations.csv --metric mae --out_folder figures



./py-sbatch.sh src/create_dataset.py \
  --output_dir sana_outputs \
  --n_train 10000 \
  --n_test 1000 \
  --batch_size 4 \
  --save_activations \
  --component_type cross_attn \
  --layers_step 5 \
  --timesteps 999




  python src/run_all_probes.py --base_folder sana_outputs --kernel_size 3 --gradient_type Horizontal --latents_name activations